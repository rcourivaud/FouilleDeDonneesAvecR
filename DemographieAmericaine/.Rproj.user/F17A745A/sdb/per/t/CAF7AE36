{
    "contents" : "# packages <- c(\"ggplot2\", \"gcookcook\", \"maps\", 'corrplot', 'rgl')\n# install.packages(packages)\n\n\nlibrary(ggplot2)\nlibrary(maps)\nlibrary(gcookbook)\nlibrary(corrplot)\nlibrary(rgl)\nlibrary(sp)\nlibrary(rgdal)\nlibrary(RColorBrewer)\nlibrary(gridExtra)\n\nsource(\"http://www.sthda.com/upload/rquery_cormat.r\")\n\ndata.pop.raw = read.csv(\"CSV//AgePop.csv\", header = TRUE, sep=';')\n\ndpt_IDF <- c(75, 77, 78, 91, 92, 93, 94, 95)\n\nylim.idf =c(48.104485,49.257756)\nxlim.idf = c(1.414525, 3.589818)\n\n\n#On supprime les 6 derniÃ¨res lignes de la DataFrame\n#Elles correspondent Ã  la moyenne sur la France et les dÃ©partements d'OutreMer\nfin <- length(data.pop.raw$P10_POP) \ndata.pop <- data.pop.raw[-c(fin:(fin-5)),]\ndata.pop$P10_jeune = data.pop$P10_0014_POP +  data.pop$P10_1529_POP + data.pop$P10_3044_POP\ndata.pop$P99_jeune = data.pop$P99_0014_POP +  data.pop$P99_1529_POP + data.pop$P99_3044_POP\n\ndata.pop$P10_vieux = data.pop$P10_4559_POP +  data.pop$P10_6074_POP + data.pop$P10_75P_POP\ndata.pop$P99_vieux = data.pop$P99_4559_POP +  data.pop$P99_6074_POP + data.pop$P99_75P_POP\ndata.pop.idf <- data.pop[data.pop$CODGEO %in% dpt_IDF,]\n\ndata_sorted <- data.pop[order(data.pop['P10_1529_POP']),]\n\nPremiers <- tail(data_sorted, 10)\nColonesAges <- c(5,7,9, 11, 13, 15)\nPremiersInteret <- Premiers[,ColonesAges]\n\nmat.premier <- t(as.matrix(PremiersInteret))\n\nn <- 6\npng('Images\\\\PartAge10DeptPeuplés.png')\ncolors.barplot.age <- rainbow(n, s = 1, v = 1, start = 0, end = max(1, n - 1)/n, alpha = 1)\nlegends <- c(\"0 à 14 ans\",\"15 à 29 ans\",\"30 à 44 ans\", \"45 à 59 ans\", \"60 à 74 ans\", \"75 ans et plus\")\nbarplot(mat.premier, names.arg = Premiers$CODGEO, las=2, col=colors.barplot.age)\nlegend(\"topleft\", legend = legends, fill = colors.barplot.age)\ntitle(\"Pourcentage de catégorie de Population\\n des 10 départements les plus peuplés\")\ndev.off()\n\n#============================================================\n#           Quantité de Population par départements\n#============================================================\n\nfrance1<-map(database=\"france\")\n#Récupère les numéros des départements correspondant à la carte\nnum <- read.csv(\"CSV//DeptNum.csv\", header= TRUE, sep=';')\nnum_cor <- num$Num\n#Renomme les départements de la carte avec leur numéro\nfrance1$names <- num_cor\n\ndata.pop.sorted <- data.pop[order(data.pop$P10_POP),]\ndpt <- data.pop.sorted$CODGEO\nmatche<-match.map(france1,dpt,exact=TRUE)\ngreys <- colorRampPalette(brewer.pal(9,\"Greys\"))(100)\ncolors<-greys[matche]\n\npng('Images//CartePopulation2010.png')\nmap(database=\"france\", fill=TRUE,col=colors,resolution=0)\ngrandesvilles <- read.csv(\"CSV//grandesvilles.csv\", header=TRUE, sep=';')\n# Mcdo <- read.csv(\"CSV//McDonald's France.csv\", header=TRUE, sep=',')\n#Ajoute les plus grandes villes sur la carte\npoints(grandesvilles$Longitude, grandesvilles$Latitude, pch=20, col = \"red\")\n# points(Mcdo$longitude, Mcdo$latitude, pch=10, col ='green')\n#Précise le nom de ces villes\ntext(grandesvilles$Longitude, grandesvilles$Latitude+0.2, grandesvilles$Nom, col=\"red\", cex = 0.5)\ntitle(\"Part de cadre dans la population de chaque département\")\nlegend(\"bottomright\", legend = rev(trunc(seq(0, trunc(data.pop.sorted$P10_POP[1]), trunc(data.pop.sorted$P10_POP[1])/10))), pch = 20, col = greys[seq(91,0, -91/11)], title=\"(en %)\")\ndev.off()\n\n#============================================================\n#           Départements les plus jeunes et les plus vieux\n#============================================================\n\n#==================================\n# =========== 1999 ================\n#==================================\n\ndata.1529.sorted99 <- data.pop[order(data.pop$P99_1529_POP),]\ndpt1529.99 <- data.1529.sorted99$CODGEO\nmatche.1529.99<-match.map(france1,dpt1529.99,exact=TRUE)\nblues <- colorRampPalette(brewer.pal(9,\"Blues\"))(100)\ncolors.1529.99<-blues[matche.1529.99]\n\npng('Images//CartePopulation15291999.png')\nmap(database=\"france\", fill=TRUE,col=colors.1529.99,resolution=0)\ngrandesvilles <- read.csv(\"CSV//grandesvilles.csv\", header=TRUE, sep=';')\n# Mcdo <- read.csv(\"CSV//McDonald's France.csv\", header=TRUE, sep=',')\n#Ajoute les plus grandes villes sur la carte\npoints(grandesvilles$Longitude, grandesvilles$Latitude, pch=20, col = \"red\")\n# points(Mcdo$longitude, Mcdo$latitude, pch=10, col ='green')\n#Précise le nom de ces villes\ntext(grandesvilles$Longitude, grandesvilles$Latitude+0.2, grandesvilles$Nom, col=\"red\", cex = 0.5)\ntitle(\"Pourcentage de 15-29 ans dans les departements en 1999\")\nlegend(\"bottomright\", legend = rev(trunc(seq(0, trunc(data.1529.sorted99$P99_1529_POP[1]), trunc(data.1529.sorted99$P99_1529_POP[1])/10))), pch = 20, col = blues[seq(91,0, -91/11)], title=\"(en %)\")\ndev.off()\n\n#==================================\n# =========== 2010 ================\n#==================================\n\n\ndata.1529.sorted10 <- data.pop[order(data.pop$P10_1529_POP),]\ndpt1529.10 <- data.1529.sorted10$CODGEO\nmatche.1529.10<-match.map(france1,dpt1529.10,exact=TRUE)\nblues <- colorRampPalette(brewer.pal(9,\"Blues\"))(100)\ncolors.1529.10<-blues[matche.1529.10]\n\npng('Images//CartePopulation15292010.png')\nmap(database=\"france\", fill=TRUE,col=colors.1529.10,resolution=0)\ngrandesvilles <- read.csv(\"CSV//grandesvilles.csv\", header=TRUE, sep=';')\n# Mcdo <- read.csv(\"CSV//McDonald's France.csv\", header=TRUE, sep=',')\n#Ajoute les plus grandes villes sur la carte\npoints(grandesvilles$Longitude, grandesvilles$Latitude, pch=20, col = \"red\")\n# points(Mcdo$longitude, Mcdo$latitude, pch=10, col ='green')\n#Précise le nom de ces villes\ntext(grandesvilles$Longitude, grandesvilles$Latitude+0.2, grandesvilles$Nom, col=\"red\", cex = 0.5)\ntitle(\"Pourcentage de 15-29 ans dans les departements en 2010\")\nlegend(\"bottomright\", legend = rev(trunc(seq(0, trunc(data.1529.sorted10$P10_1529_POP[1]), trunc(data.1529.sorted10$P10_1529_POP[1])/10))), pch = 20, col = blues[seq(91,0, -91/11)], title=\"(en %)\")\ndev.off()\n\n#============================================================\n#           Jeune en fonction de la population\n#============================================================\n\nggplot(data.pop, aes(x=data.pop$P10_jeune, y=data.pop$P10_POP)) +\n  geom_point(shape=1) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data.pop$CODGEO), size=4, hjust=-1, vjust=-1) +\n  ggtitle(\"Pourcentage de jeunes par département\\nen fonction de la population\")+\n  labs(x = \"Pourcentage de 15-29 ans\", y = \"Population totale\")\nggsave(file=\"Pourcentage_de_jeune_population.png\")\n\n# ----- 2010\nggplot(data.pop, aes(x=data.pop$P10_1529_POP, y=data.pop$P10_75P_POP)) +\n  geom_point(aes(size=data.pop$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data.pop$CODGEO), size=4, hjust=-1, vjust=-1) +\n  ggtitle(\"Pourcentage de très jeunes par rapport aux très vieux par département en 2010\")+\n  labs(x = \"Pourcentage de 15-29 ans\", y = \"Pourcentage de 75 ans et plus\")\nggsave(file=\"Images\\\\Pourcentage_très_jeunes_vieux_2010.png\")\n\n# ----- 1999\nggplot(data.pop, aes(x=data.pop$P99_1529_POP, y=data.pop$P99_75P_POP)) +\n  geom_point(aes(size=data.pop$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data.pop$CODGEO), size=4, hjust=-1, vjust=-1) +\n  ggtitle(\"Pourcentage de très jeunes par rapport aux très vieux par départementen 1999\")+\n  labs(x = \"Pourcentage de 15-29 ans\", y = \"Pourcentage de 75 ans et plus\")\nggsave(file=\"Images\\\\Pourcentage_très_jeunes_vieux_1999.png\")\n#=================================\n#       Pop jeune vieux \n#                IDF\n# ===============================\n\n# 1999 \n\nggplot(data.pop, aes(x=data.pop.idf$P99_jeune, y=data.pop.idf$P99_vieux)) +\n  geom_point(aes(size=data.pop.idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data.pop.idf$CODGEO), size=4, hjust=-1, vjust=-1) +\n  ggtitle(\"Pourcentage de jeunes par rapport aux vieux par département en 1999\")+\n  labs(x = \"Pourcentage de 00-44 ans\", y = \"Pourcentage de 45 ans et plus\")\nggsave(file=\"Images\\\\Pourcentage_idf_jeune_vieux_1999.png\")\n\n#2010\n\nggplot(data.pop, aes(x=data.pop.idf$P10_jeune, y=data.pop.idf$P10_vieux)) +\n  geom_point(aes(size=data.pop.idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data.pop.idf$CODGEO), size=4, hjust=-1, vjust=-1) +\n  ggtitle(\"Pourcentage de jeunes par rapport aux vieux par département en 2010\")+\n  labs(x = \"Pourcentage de 00-44 ans\", y = \"Pourcentage de 45 ans et plus\")\nggsave(file=\"Images\\\\Pourcentage_idf_jeune_vieux_2010.png\")\n\n# ggplot(data.pop, aes(x=data.pop$P10_POP)) + \n#   geom_histogram(binwidth = 0.5)\n\nggplot(data.pop, aes(x=data.pop$P10_1529_POP)) + \n  geom_histogram(binwidth = 1)+\n  ggtitle(\"Distribution du pourcentage de 15-29 ans par département en 2010\")+\n  geom_vline(aes(xintercept=mean(data.pop$P10_1529_POP, na.rm=T)),  color=\"red\", linetype=\"dashed\", size=1) + \n  labs(y = \"Count\", x = \"Pourcentage de 15-29 ans\")\nggsave(file=\"Images\\\\Distribution1529_Dept2010.png\")\n\nggplot(data.pop, aes(x=data.pop$P99_1529_POP)) + \n  geom_histogram(binwidth = 1)+\n  ggtitle(\"Distribution du pourcentage de 15-29 ans par département en 1999\")+\n  geom_vline(aes(xintercept=mean(data.pop$P99_1529_POP, na.rm=T)),  color=\"red\", linetype=\"dashed\", size=1) + \n  labs(x = \"Pourcentage de 15-29 ans\", y = \"Count\")\nggsave(file=\"Images\\\\Distribution1529_Dept1999.png\")\n\n#============================================================\n#           Emploi par département de la Pop active\n#============================================================\n\nemploi <- read.csv(\"CSV//EmploiPopActive.csv\", sep = ';', header=TRUE)\nemploi_column <- c(\"CODGEO\", \"LIBGEO\", \"P10_ACT1564\", \"P10_CHOM1564\", \"P10_CHOM_ACT1564\",  \"P99_CHOM_ACT1564\")\nemploi <- emploi[emploi_column]\nemploi['Diff1099'] <- emploi['P10_CHOM_ACT1564'] - emploi['P99_CHOM_ACT1564']\nemploi['RatioActifsChomeurs'] <- (emploi['P10_ACT1564'] - emploi['P10_CHOM1564']) / emploi['P10_CHOM1564']\n\nggplot(emploi, aes(x=emploi$P10_ACT1564, y=emploi$P10_CHOM1564)) +\n  geom_point(shape=1) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=emploi$CODGEO), size=4, hjust=-1, vjust=-1)\n\n#On voit qu'il n'y a pas vraiment de départements qui sortent du lot\n\nggplot(emploi, aes(x=emploi$Diff1099)) + \n  geom_histogram(binwidth = 0.5)+\n  ggtitle(\"Distribution de la différence de chomeur entre 1999 et 2010\")+\n  geom_vline(aes(xintercept=mean(emploi$Diff1099, na.rm=T)),  color=\"red\", linetype=\"dashed\", size=1) + \n  labs(x = \"Différence de chomeurs entre 1999 et 2010\", y = \"Count\")\nggsave(file=\"Images\\\\Distribution_diffChomeur_9910.png\")\n\npairs(emploi)\n\n#On voit une légère corélation entre le pourcentage de chomeurs en 2010 et en 1999 \n#On voit qu'en général la plupart des départements garde une même dynamique\n\n# =====================================================================\n# ---------------------------- IDF -----------------------------------\n# =====================================================================\n\nemploi_idf = emploi[emploi$CODGEO %in% dpt_IDF,]\ndata_idf = data.pop[data.pop$CODGEO %in% dpt_IDF,]\n\n# ----- 2010\nggplot(data_idf, aes(x=data_idf$P10_1529_POP, y=data_idf$P10_75P)) +\n  geom_point(aes(size=data_idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data_idf$CODGEO), size=4, hjust=-1, vjust=-1)+  \n  ggtitle(\"Pourcentage de très jeunes par rapport au très vieux par département en 2010\") +\n  labs(x = \"Pourcentage de 15-29 ans \", y = \"Pourcentage de 75 ans et plus\")\nggsave(file=\"Images\\\\Pourcentage_idf_Tres_jeunes_vieux_2010.png\")\n\n# ------ 1999\nggplot(data_idf, aes(x=data_idf$P99_1529_POP, y=data_idf$P99_75P)) +\n  geom_point(aes(size=data_idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data_idf$CODGEO), size=4, hjust=-1, vjust=-1)+\n  ggtitle(\"Pourcentage de très jeunes par rapport au très vieux par département en 1999\") +\n  labs(x = \"Pourcentage de 15-29 ans \", y = \"Pourcentage de 75 ans et plus\")\nggsave(file=\"Images\\\\Pourcentage_idf_Tres_jeunes_vieux_1999.png\")\n\nggplot(data_idf, aes(x=data_idf$P10_1529_POP, y=data_idf$P10_POP)) +\n  geom_point(shape=1) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=data_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\n\n#============================================================\n#           Chomage dans les départements francais\n#============================================================\n\nfrance1<-map(database=\"france\")\n#Récupère les numéros des départements correspondant à la carte\nnum <- read.csv(\"CSV//DeptNum.csv\", header= TRUE, sep=';')\nnum_cor <- num$Num\n#Renomme les départements de la carte avec leur numéro\nfrance1$names <- num_cor\n\nemploi.chomage2010 <- emploi[order(emploi$P10_CHOM_ACT1564),]\nemploi.chomage1999 <- emploi[order(emploi$P99_CHOM_ACT1564),]\ndpt.chom99 <- emploi.chomage1999$CODGEO\ndpt.chom10 <- emploi.chomage2010 $CODGEO\nmatche.chomage1999<-match.map(france1,dpt.chom99,exact=TRUE)\nmatche.chomage2010<-match.map(france1,dpt.chom10,exact=TRUE)\n\nyellows <- colorRampPalette(brewer.pal(9,\"YlOrRd\"))(100)\n\ncolors.chomage2010<-yellows[matche.chomage2010]\ncolors.chomage1999<-yellows[matche.chomage1999]\ngrandesvilles <- read.csv(\"CSV//grandesvilles.csv\", header=TRUE, sep=';')\n\n# ------------- 2010 \nmap(database=\"france\", fill=TRUE,col=colors.chomage2010,resolution=0)\npoints(grandesvilles$Longitude, grandesvilles$Latitude, pch=20, col = \"black\")\ntext(grandesvilles$Longitude, grandesvilles$Latitude+0.2, grandesvilles$Nom, col=\"black\", cex = 0.5)\ntitle(\"Part de cadre dans la population de chaque département\")\nlegend(\"bottomleft\", legend = trunc(seq(0, trunc(cadre_p$C10_CADRE[1]), trunc(cadre_p$C10_CADRE[1])/10)), pch = 20, col = reds[seq(91,0, -91/11)], title=\"(en %)\")\n\n#------------- 1999\nmap(database=\"france\", fill=TRUE,col=colors.chomage1999,resolution=0)\npoints(grandesvilles$Longitude, grandesvilles$Latitude, pch=20, col = \"black\")\ntext(grandesvilles$Longitude, grandesvilles$Latitude+0.2, grandesvilles$Nom, col=\"black\", cex = 0.5)\ntitle(\"Part de cadre dans la population de chaque département\")\nlegend(\"bottomleft\", legend = trunc(seq(0, trunc(cadre_p$C10_CADRE[1]), trunc(cadre_p$C10_CADRE[1])/10)), pch = 20, col = reds[seq(91,0, -91/11)], title=\"(en %)\")\n\n#============================================================\n#          Différence de salaire entre les départements\n#============================================================\n\nsalary <- read.csv('CSV//Salaires2012_clean.csv', sep=';', header=TRUE)\nsalary_dept <- aggregate(salary,by = list(car=salary$Dept), FUN=mean)\npairs(salary_dept)\nhead(salary_dept)\n\nS <- salary_dept[c(1, 5,6,7,8,9)]\nS$CODGEO <- S$car\nPop <- data[c(2, 4)]\n\nSalaire_Pop <- merge(Pop,S, by ='CODGEO')\n\npairs(Salaire_Pop)\n\n#On voit une corrélation entre les différents salaires selon les emplois\n#Ce qui implique qu'en général les salaires entre les différentes classes sociales\n#Ne subissent pas des écarts très importants\n\nggplot(Salaire_Pop, aes(x=Salaire_Pop$SC, y=Salaire_Pop$SO)) +\n  geom_point(aes(size=Salaire_Pop$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=Salaire_Pop$CODGEO), size=4, hjust=-1, vjust=-1)\n\n#On voit que le département ou les cadres sont le mieux payé est Paris \n#Et que le département ou les Ouvries sont le mieux payé est le 92 \n\n# ----------------------- IDF ----------------------------------------\n\n#Plus précisément pour les départements d'ile de France\n\n\nSalaire_Pop_idf = Salaire_Pop[Salaire_Pop$CODGEO %in% dpt_IDF,]\n\nggplot(Salaire_Pop, aes(x=Salaire_Pop_idf$SC, y=Salaire_Pop_idf$SO)) +\n  geom_point(aes(size=Salaire_Pop_idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=Salaire_Pop_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\n#On voit ici qu'il existe une très grande variation de salaire entre\n#les département d'ile de France\n\ntest <- merge(Salaire_Pop, emploi, by='CODGEO')\ntest_interet <- test[c(1,2, 4, 12)]\npairs(test_interet)\n\n#On observe une certaine corrélation entre le salaire et la Population du département\n\nggplot(test, aes(x=test$S, y=test$P10_POP)) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=test$CODGEO), size=4, hjust=-1, vjust=-1)\n\n# ==============================================================\n# ------------- Mise en commun de toutes les données ------------\n# ===============================================================\n\ntotal_idf <- merge(data_idf, emploi_idf, by='CODGEO')\ntotal_idf_final <-  merge(total_idf,Salaire_Pop_idf, by='CODGEO')\ntotal_idf_final <- total_idf_final[c(1, 4, 5, 7, 9, 11, 13, 15, 18, 20,26, 27, 28, 29, 30)]\nrquery.cormat(total_idf_final[c(2,3,4,5,6,7, 8,9,10,11, 12, 13, 14, 15)])\n\n#On observe pas de corrélation flagrante intérressante entre les différentes \n#Variable utilisées jusque la\n\n\n# ===================================================================\n# ------------- Logement ----------------\n# ===================================================================\n\nLogement <- read.csv(\"CSV//Logement.csv\", header=TRUE, sep=';')\nfin_logement <- length(Logement$CODGEO)\nLogement <- Logement[-c(fin_logement:(fin_logement-5)),-c(1, 3, 6, 8)]\n\nData_interet_logement <- data[c(2, 4,5, 7, 9, 11, 13, 15)]\n\nLogement_Pop <- merge(Data_interet_logement, Logement, by='CODGEO')\nrquery.cormat(Logement_Pop[c(2,3,4,5,6,7, 8,9,10, 11)])\n\npairs(Logement_Pop)\n\n#On voit une corrélation entre le pourcentage de population 'jeune' \n# Et la part d'appartement dans les départements. On sait que les jeunes \n# préfèrent les appartements pour leur prix et parcequ'ils sont souvent \n# dans des villes plus dynamiques donc ou il y a le plus de travail\n\nSalaire_Logement_pop <- merge(Logement_Pop, Salaire_Pop, by='CODGEO')\npairs(Salaire_Logement_pop)\nrquery.cormat(Salaire_Logement_pop[c(2,3,4,5,6,7,8,9,10,11, 12, 14, 15, 16, 17, 18)])\n\n\n# ---------------------- IDF ------------------------------------\n\nLogement_pop_idf <- Logement_Pop[Logement_Pop$CODGEO %in% dpt_IDF,]\n\npairs(Logement_pop_idf)\nrquery.cormat(Logement_pop_idf[c(2,3,4,5,6,7,8,9,10,11)])\n\nggplot(Logement_pop_idf, aes(x=Logement_pop_idf$P10_MAISON_LOG, y=Logement_pop_idf$P10_APPART_LOG)) +\n  geom_point(aes(size=Logement_pop_idf$P10_LOG),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=Logement_pop_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\n\n# ===================================================================\n# -------------------- Taux Natalité/Mortalité ----------------------\n# ===================================================================\n\nTxNat <- read.csv('CSV//TxNat.csv', header=TRUE, sep=';')\nTxMort <- read.csv('CSV//TxMort.csv', header=TRUE, sep=';')\n\nTxNatMort_raw <- merge(TxNat, TxMort, by='CODGEO')\nTxNatMort <- TxNatMort_raw[,-c(2, 3, 9, 10)]\npairs(TxNatMort)\nrquery.cormat(TxNatMort[c(2,3,4,5,6,7,8,9,10,11)])\n\n#On voit bien que le taux de mortalité est très corrélé avec les taux\n#de mortalité la même année (en effet il est inversement proportionel)\n#On en déduit que plus un département possède un taux élevé de natalité\n#Il possède aussi un très faible taux de mortalité\nTxNatMort_idf <- TxNatMort[TxNatMort$CODGEO %in% dpt_IDF,]\n\n\nggplot(TxNatMort_idf, aes(x=TxNatMort_idf$TNAT9910, y=TxNatMort_idf$TMOR9910)) +\n  geom_point(aes(size=data_idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=TxNatMort_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\nggplot(TxNatMort_idf, aes(x=TxNatMort_idf$TNAT9099, y=TxNatMort_idf$TMOR9099)) +\n  geom_point(aes(size=data_idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=TxNatMort_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\nggplot(TxNatMort_idf, aes(x=TxNatMort_idf$TNAT8290, y=TxNatMort_idf$TMOR8290)) +\n  geom_point(aes(size=data_idf$P10_POP),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=TxNatMort_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\nggplot(TxNatMort_idf, aes(x=TxNatMort_idf$TNAT7582, y=TxNatMort_idf$TMOR7582)) +\n  geom_point(aes(size=data_idf$P10_LOG),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=TxNatMort_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\nggplot(TxNatMort_idf, aes(x=TxNatMort_idf$TNAT6875, y=TxNatMort_idf$TMOR6875)) +\n  geom_point(aes(size=data_idf$P10_LOG),shape=1) +\n  scale_size_continuous(range = c(3, 10)) +\n  geom_smooth(method=lm) + \n  geom_text(aes(label=TxNatMort_idf$CODGEO), size=4, hjust=-1, vjust=-1)\n\n\nTxNatMort_2010 <- TxNatMort[c(1,2, 7)]\nTx_log <- merge(TxNatMort_2010, Logement_Pop, by='CODGEO')\npairs(Tx_log)\nrquery.cormat(Tx_log[c(2,3,4,5,6,7,8,9,10,11,12,13)])\n\n#On voit ici que plus le département possède un population jeune\n#plus le taux de natalité est important ce qui est plutot normal dans l'ensemble\n#Mais aussi que plus la population est vieille plus le taux de mortalité est élevé\n#On a donc au fil des ans des départements qui vont devenir de plus en plus vieux\n#Et d'autre qui vont devenir de plus en plus jeune ce qui va impacté très fortement \n#L'aspect économique de ces derniers.\nTx_Salaire <- merge(TxNatMort_2010, Salaire_Pop, by ='CODGEO')\npairs(Tx_Salaire)\nrquery.cormat(Tx_Salaire[c(2,3,4,6,7,8,9,10)])\n\n\n#Interpréation : \n\n# ==================================================================\n# ------------- Différents part d'emploi dans les depts ------------\n# ==================================================================\n\nemploi_pop <- read.csv('CSV//EmploiPop.csv', sep=';', header=TRUE)\nfin_emploi_pop <- length(emploi_pop$CODGEO)\nemploi_pop <- emploi_pop[-c(fin_emploi_pop:(fin_emploi_pop-5)),]\nemploi_pop_2010 <- emploi_pop[,c(2, 4, 5, 7, 9, 11, 13, 15, 17, 19)]\npairs(emploi_pop_2010)\n\nrquery.cormat(emploi_pop_2010[c(2,3,4,6,7,8,9,10)])\n# ==============================================\n\nagri_p <- emploi_pop_2010[order(-emploi_pop_2010$C10_AGRI),]\ncadre_p <- emploi_pop_2010[order(-emploi_pop_2010$C10_CADRE),]\nprof_p <- emploi_pop_2010[order(-emploi_pop_2010$C10_PROF),]\n\ndpt_agri <- agri_p$CODGEO\ndpt_cadre <- cadre_p$CODGEO\ndpt_prof <- prof_p$CODGEO\n\nN.emploi <- length(emploi_pop_2010$CODGEO)\n\nylim_idf =c(48.104485,49.257756)\nxlim_idf = c(1.414525, 3.589818)\n\nmatch_agri <- match.map(france1,dpt_agri)\ngreens <- rev(colorRampPalette(brewer.pal(9,\"Greens\"))(100))\ncolor_agri <- greens[match_agri]\nmap(database=\"france\", fill=TRUE, col=color_agri)\ntitle(\"Part d'agriculteur dans la population de chaque département\")\nlegend(\"bottomleft\", legend = seq(0, trunc(agri_p$C10_AGRI[1]), trunc(agri_p$C10_AGRI[1])/10), pch = 20, col = greens[seq(91,0, -91/11)], title='(en%)' )\n# points(bureau_poste$Longitude, bureau_poste$Latitude, col='black')\n\n\nmatch_cadre <- match.map(france1,dpt_cadre)\nreds <- rev(colorRampPalette(brewer.pal(9,\"Reds\"))(100))\ncolor_cadre <- reds[match_cadre]\nmap(database=\"france\", fill=TRUE, col=color_cadre)\ntitle(\"Part de cadre dans la population de chaque département\")\nlegend(\"bottomleft\", legend = trunc(seq(0, trunc(cadre_p$C10_CADRE[1]), trunc(cadre_p$C10_CADRE[1])/10)), pch = 20, col = reds[seq(91,0, -91/11)], title=\"(en %)\")\n\nmatch_prof <- match.map(france1,dpt_prof)\nblues <- rev(colorRampPalette(brewer.pal(9,\"Blues\"))(100))\ncolor_prof <- blues[match_prof]\nmap(database=\"france\", fill=TRUE, col=color_prof)\ntitle(\"Part de prof dans la population de chaque département\")\nlegend(\"bottomleft\", legend = trunc(seq(0, trunc(prof_p$C10_PROF[1]), trunc(prof_p$C10_PROF[1])/10)), pch = 20, col = blues[seq(91,0, -91/11)], title=\"(en %)\" )\n\ndisplay.brewer.all()\nggplot(aggdata.zipcode,aes(map_id=aggdata.zipcode$Group.1,fill=aggdata.zipcode$x)) +\n  geom_map(map =france,colour=\"black\") +\n  scale_fill_gradient2(low=\"#559999\",mid=\"grey90\",high=\"#BB650B\",\n                       midpoint=median(aggdata.zipcode$x)) +\n  expand_limits(x =france$long,y =france$lat) +\n  coord_map(\"polyconic\")\n",
    "created" : 1445588473551.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2582244094",
    "id" : "CAF7AE36",
    "lastKnownWriteTime" : 1445548593,
    "path" : "C:/Users/Raphaël/Desktop/Projet Data/DRIO4101A/PopGraphics1.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}